<html><head>
<script>module = {};</script>
<script src="jsGoo.9.js"></script>
<script src="interpreter2.js"></script>
<script>
  function interpretTree(p) {
/*  var p =  module.parser.parse("[ "+x+" ]"); 
  $get("parsed").innerHTML = p;
  console.debug(p); */
  var r = bagel.evalu(p,0,{});
  console.debug("RETURNED =>");
  console.debug(r);
  $get("ctx").innerHTML = _c.reduceObj(function(acc,k,v){return acc+"<li><b>"+k+"</b> "+v+"</li>"},r[2],"");
  return r
  }
</script>
</head>
<body onload="bagel = Bagel(1);"><h3>Bagel</h3>
<small>I hope you can figure out what's going on, it's very simple :)</small><br/><br/>
<textarea id="code" cols="30" rows="40">[
   [
      "setword",
      "num1"
   ],
   [
      "word",
      "inc"
   ],   
   [
      "number",
      33
   ],
   [
      "setword",
      "pers"
   ],
   [
      "word",
      "ctx"
   ],
   [
      "block",
      [
         "word",
         "name"
      ],
      [
         "word",
         "age"
      ]
   ],
   [
      "setword",
      "num2"
   ],
   [
      "number",
      120
   ],
   [
      "setword",
      "person"
   ],
   [
      "word",
      "makectx"
   ],
   [
      "word",
      "pers"
   ],
   [
      "setword",
      "increment"
   ],
   [
      "word",
      "fn"
   ],
   [
      "block",
      [
         "word",
         "x"
      ]
   ],
   [
      "block",
      [
         "word",
         "inc"
      ],
      [
         "word",
         "inc"
      ],
      [
         "word",
         "x"
      ],
   ],
   [
      "setword",
      "num3"
   ],
   [
      "word",
      "inc"
   ],   
   [
      "word",
      "increment"
   ],   
   [
      "number",
      102
   ],
]</textarea><br/>
<!--textarea id="code" cols="30" rows="40">[
   [
      "setword",
      "pers"
   ],
   [
      "word",
      "ctx"
   ],
   [
      [
         "word",
         "name"
      ],
      [
         "word",
         "age"
      ]
   ],
   [
      "setword",
      "sayhi"
   ],
   [
      "word",
      "bag"
   ],
   [
      [
         "callword",
         "pers"
      ]
   ],
   [
      [
         "string",
         "hi"
      ],
      [
         "coword",
         "name"
      ],
      [
         "word",
         "join"
      ],
      [
         "word",
         "print"
      ]
   ],
   [
      "callword",
      "pers"
   ],
   [
      "string",
      "jim"
   ],
   [
      "ciword",
      "name"
   ],
   [
      "word",
      "sayhi"
   ]
]</textarea--><br/>
<input type="button" value="interpret" onclick="document.getElementById('out').innerHTML = interpretTree(eval(document.getElementById('code').value));" />
<h5>parsed</h5>
<pre id="parsed">...</pre>
<h5>result</h5>
<pre id="out">...</pre>
<h5>context state</h5>
<pre id="ctx">...</pre>

</body></html>
